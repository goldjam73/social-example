!function(){"use strict";function t(t,o){var n=this;n.login=function(){o.login(n.username,n.password).then(function(o){n.onUpdate({value:o.data}),t.path("/")})}}function o(){var t=this;t.addPost=function(){null!==t.postBody&&t.onUpdate({value:t.postBody})}}function n(t,o){var n=this;n.postBody=null,n.addPost=function(t){o.create({body:t}).then(function(){n.postBody=null})},t.$on("ws:new_post",function(o,e){t.$apply(function(){n.posts.unshift(e)})}),o.fetch().then(function(t){n.posts=t.data})}function e(){var t=this;t.login=function(o){t.currentUser=o},t.logout=function(){t.currentUser=null}}t.$inject=["$location","UserSvc"],n.$inject=["$scope","PostsSvc"],angular.module("social-app",["ngRoute"]).config(["$locationProvider",function(t){t.hashPrefix(""),t.html5Mode(!0)}]),angular.module("social-app").component("login",{controller:t,templateUrl:"login.html",bindings:{onUpdate:"&"}}),angular.module("social-app").component("postInput",{controller:o,templateUrl:"postinput.html",bindings:{postBody:"<",onUpdate:"&"}}),angular.module("social-app").component("postItem",{templateUrl:"postitem.html",bindings:{post:"<"}}),angular.module("social-app").component("posts",{controller:n,templateUrl:"posts.html"}),angular.module("social-app").service("PostsSvc",["$http",function(t){this.fetch=function(){return t.get("/api/posts")},this.create=function(o){return t.post("/api/posts",o)}}]),angular.module("social-app").config(["$routeProvider",function(t){t.when("/",{template:"<posts></posts>"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{template:'<login on-update="$ctrl.login(value)"></login>'})}]),angular.module("social-app").component("social",{controller:e,templateUrl:"social.html"}),angular.module("social-app").service("UserSvc",["$http",function(t){var o=this;o.getUser=function(){return t.get("/api/users")},o.login=function(n,e){return t.post("/api/sessions",{username:n,password:e}).then(function(n){return o.token=n.data,t.defaults.headers.common["X-Auth"]=n.data,o.getUser()})}}]),angular.module("social-app").run(["$rootScope","$timeout",function(t,o){function n(){return"https:"===window.location.host?"wss://"+window.location.host:"ws://"+window.location.host}!function e(){var a=new WebSocket(n());a.onclose=function(){console.log("WebSocket closed. Reconnecting..."),o(e,1e4)},a.onmessage=function(o){var n=JSON.parse(o.data);t.$broadcast("ws:"+n.topic,n.data)}}()}])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luLmNvbXBvbmVudC5qcyIsImFwcC5qcyIsInBvc3RpbnB1dC5jb21wb25lbnQuanMiLCJwb3N0cy5jb21wb25lbnQuanMiLCJzb2NpYWwuY29tcG9uZW50LmpzIiwicG9zdGl0ZW0uY29tcG9uZW50LmpzIiwicG9zdHMuc2VydmljZS5qcyIsInJvdXRlcy5qcyIsInVzZXIuc2VydmljZS5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiTG9naW5Db250cm9sbGVyIiwiJGxvY2F0aW9uIiwiVXNlclN2YyIsInZtIiwidGhpcyIsImxvZ2luIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInRoZW4iLCJyZXNwb25zZSIsIm9uVXBkYXRlIiwidmFsdWUiLCJkYXRhIiwicGF0aCIsIlBvc3RJbnB1dENvbnRyb2xsZXIiLCJhZGRQb3N0IiwicG9zdEJvZHkiLCJQb3N0c0NvbnRyb2xsZXIiLCIkc2NvcGUiLCJQb3N0c1N2YyIsImNyZWF0ZSIsImJvZHkiLCIkb24iLCJfIiwicG9zdCIsIiRhcHBseSIsInBvc3RzIiwidW5zaGlmdCIsImZldGNoIiwiU29jaWFsQ29udHJvbGxlciIsInVzZXIiLCJjdXJyZW50VXNlciIsImxvZ291dCIsIiRpbmplY3QiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJoYXNoUHJlZml4IiwiaHRtbDVNb2RlIiwiY29tcG9uZW50IiwiY29udHJvbGxlciIsInRlbXBsYXRlVXJsIiwiYmluZGluZ3MiLCJzZXJ2aWNlIiwiJGh0dHAiLCJnZXQiLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZSIsInN2YyIsImdldFVzZXIiLCJ2YWwiLCJ0b2tlbiIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsInJ1biIsIiRyb290U2NvcGUiLCIkdGltZW91dCIsIndlYlNvY2tldEhvc3QiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhvc3QiLCJjb25uZWN0IiwiY29ubmVjdGlvbiIsIldlYlNvY2tldCIsIm9uY2xvc2UiLCJjb25zb2xlIiwibG9nIiwib25tZXNzYWdlIiwiZSIsInBheWxvYWQiLCJKU09OIiwicGFyc2UiLCIkYnJvYWRjYXN0IiwidG9waWMiXSwibWFwcGluZ3MiOiJ3QkFBQSxTQUFBQSxHQUFBQyxFQUFBQyxHQ09BLEdBQUFDLEdBQUFDLElEUEFELEdBQUFFLE1BQUEsV0NTQUgsRUFBQUcsTUFBQUYsRUFBQUcsU0FBQUgsRUFBQUksVUFDQUMsS0FBQSxTQUFBQyxHQUNBTixFQUFBTyxVQUNBQyxNQUFBRixFQUFBRyxPQUVBWCxFQUFBWSxLQUFBLFFDZEEsUUFBQUMsS0Q0QkEsR0FBQVgsR0FBQUMsSUM1QkFELEdBQUFZLFFBQUEsV0Q4QkEsT0FBQVosRUFBQWEsVUFDQWIsRUFBQU8sVUFDQUMsTUFBQVIsRUFBQWEsWUVoQ0EsUUFBQUMsR0FBQUMsRUFBQUMsR0Z1REEsR0FBQWhCLEdBQUFDLElFdkRBRCxHQUFBYSxTQUFBLEtGeURBYixFQUFBWSxRQUFBLFNBQUFKLEdBQ0FRLEVBQUFDLFFBQ0FDLEtBQUFWLElBQ0FILEtBQUEsV0FDQUwsRUFBQWEsU0FBQSxRQUlBRSxFQUFBSSxJQUFBLGNBQUEsU0FBQUMsRUFBQUMsR0FDQU4sRUFBQU8sT0FBQSxXQUNBdEIsRUFBQXVCLE1BQUFDLFFBQUFILE9BSUFMLEVBQUFTLFFBQUFwQixLQUFBLFNBQUFDLEdBQ0FOLEVBQUF1QixNQUFBakIsRUFBQUcsT0d4RUEsUUFBQWlCLEtINkdBLEdBQUExQixHQUFBQyxJRzdHQUQsR0FBQUUsTUFBQSxTQUFBeUIsR0grR0EzQixFQUFBNEIsWUFBQUQsR0FFQTNCLEVBQUE2QixPQUFBLFdBQ0E3QixFQUFBNEIsWUFBQSxNQWpIQS9CLEVBQUFpQyxTQUFBLFlBQUEsV0FDQWhCLEVBQUFnQixTQUFBLFNBQUEsWUFBQUMsUUFBQUMsT0FBQSxjQURBLFlBQ0FDLFFBQUEsb0JBQUEsU0FBQUMsR0FDQUEsRUFBQUMsV0FBQSxJQUNBRCxFQUFBRSxXQUFBLE1EU0FMLFFBQUFDLE9BQUEsY0NPQUssVUFBQSxTRFBBQyxXQUFBekMsRUNTQTBDLFlBQUEsYUFDQUMsVUFDQWpDLFNBQUEsT0NiQXdCLFFBQUFDLE9BQUEsY0Q0QkFLLFVBQUEsYUM1QkFDLFdBQUEzQixFRDhCQTRCLFlBQUEsaUJBQ0FDLFVBQ0EzQixTQUFBLElBQ0FOLFNBQUEsT0k1Q0F3QixRQUFBQyxPQUFBLGNKZ0RBSyxVQUFBLFlJaERBRSxZQUFBLGdCSmtEQUMsVUFDQW5CLEtBQUEsT0U3QkFVLFFBQUFDLE9BQUEsY0Z1REFLLFVBQUEsU0V2REFDLFdBQUF4QixFRnlEQXlCLFlBQUEsZUsvRUFSLFFBQUFDLE9BQUEsY0xrRkFTLFFBQUEsWUtsRkEsUUFBQSxTQUFBQyxHTG9GQXpDLEtBQUF3QixNQUFBLFdBQ0EsTUFBQWlCLEdBQUFDLElBQUEsZUFFQTFDLEtBQUFnQixPQUFBLFNBQUFJLEdBQ0EsTUFBQXFCLEdBQUFyQixLQUFBLGFBQUFBLE9NeEZBVSxRQUFBQyxPQUFBLGNOOEZBQyxRQUFBLGlCQUFBLFNBQUFXLEdNOUZBQSxFTmdHQUMsS0FBQSxLQUNBQyxTQUFBLG9CQUVBRCxLQUFBLGFBQ0FQLFdBQUEsZUFDQUMsWUFBQSxrQkFFQU0sS0FBQSxVQUNBQyxTQUFBLHNERzlGQWYsUUFBQUMsT0FBQSxjSDZHQUssVUFBQSxVRzdHQUMsV0FBQVosRUgrR0FhLFlBQUEsZ0JPekhBUixRQUFBQyxPQUFBLGNQNEhBUyxRQUFBLFdBQUEsUUFBQSxTQUFBQyxHTzVIQSxHQUFBSyxHQUFBOUMsSVA4SEE4QyxHQUFBQyxRQUFBLFdBQ0EsTUFBQU4sR0FBQUMsSUFBQSxlQUVBSSxFQUFBN0MsTUFBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFzQyxHQUFBckIsS0FBQSxpQkFDQWxCLFNBQUFBLEVBQ0FDLFNBQUFBLElBQ0FDLEtBQUEsU0FBQTRDLEdBR0EsTUFGQUYsR0FBQUcsTUFBQUQsRUFBQXhDLEtBQ0FpQyxFQUFBUyxTQUFBQyxRQUFBQyxPQUFBLFVBQUFKLEVBQUF4QyxLQUNBc0MsRUFBQUMsZ0JReElBakIsUUFBQUMsT0FBQSxjUjZJQXNCLEtBQUEsYUFBQSxXQUFBLFNBQUFDLEVBQUFDLEdRN0lBLFFBQUFDLEtSK0lBLE1BQUEsV0FBQUMsT0FBQUMsU0FBQUMsS0FDQSxTQUFBRixPQUFBQyxTQUFBQyxLQUVBLFFBQUFGLE9BQUFDLFNBQUFDLE1BR0EsUUFBQUMsS0FDQSxHQUFBQyxHQUFBLEdBQUFDLFdBQUFOLElBQ0FLLEdBQUFFLFFBQUEsV0FDQUMsUUFBQUMsSUFBQSxxQ0FDQVYsRUFBQUssRUFBQSxNQUVBQyxFQUFBSyxVQUFBLFNBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsS0FBQUMsTUFBQUgsRUFBQTNELEtBQ0E4QyxHQUFBaUIsV0FBQSxNQUFBSCxFQUFBSSxNQUFBSixFQUFBNUQiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gTG9naW5Db250cm9sbGVyKCRsb2NhdGlvbiwgVXNlclN2Yykge1xyXG5cdHZhciB2bSA9IHRoaXM7XHJcblx0dm0ubG9naW4gPSBmdW5jdGlvbigpIHtcclxuXHRcdFVzZXJTdmMubG9naW4odm0udXNlcm5hbWUsIHZtLnBhc3N3b3JkKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG5cdFx0XHRcdHZtLm9uVXBkYXRlKHtcclxuXHRcdFx0XHRcdHZhbHVlOiByZXNwb25zZS5kYXRhXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0JGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuXHRcdFx0fSk7XHJcblx0fTtcclxufVxyXG5cclxuYW5ndWxhci5tb2R1bGUoJ3NvY2lhbC1hcHAnKVxyXG5cdC5jb21wb25lbnQoJ2xvZ2luJywge1xyXG5cdFx0Y29udHJvbGxlcjogTG9naW5Db250cm9sbGVyLFxyXG5cdFx0dGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJyxcclxuXHRcdGJpbmRpbmdzOiB7XHJcblx0XHRcdG9uVXBkYXRlOiAnJidcclxuXHRcdH1cclxuXHR9KTsiLG51bGwsImZ1bmN0aW9uIFBvc3RJbnB1dENvbnRyb2xsZXIoKSB7XHJcblx0dmFyIHZtID0gdGhpcztcclxuXHR2bS5hZGRQb3N0ID0gZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAodm0ucG9zdEJvZHkgIT09IG51bGwpIHtcclxuXHRcdFx0dm0ub25VcGRhdGUoe1xyXG5cdFx0XHRcdHZhbHVlOiB2bS5wb3N0Qm9keVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9O1xyXG59XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnc29jaWFsLWFwcCcpXHJcblx0LmNvbXBvbmVudCgncG9zdElucHV0Jywge1xyXG5cdFx0Y29udHJvbGxlcjogUG9zdElucHV0Q29udHJvbGxlcixcclxuXHRcdHRlbXBsYXRlVXJsOiAncG9zdGlucHV0Lmh0bWwnLFxyXG5cdFx0YmluZGluZ3M6IHtcclxuXHRcdFx0cG9zdEJvZHk6ICc8JyxcclxuXHRcdFx0b25VcGRhdGU6ICcmJ1xyXG5cdFx0fVxyXG5cdH0pOyIsImZ1bmN0aW9uIFBvc3RzQ29udHJvbGxlcigkc2NvcGUsIFBvc3RzU3ZjKSB7XHJcblx0dmFyIHZtID0gdGhpcztcclxuXHR2bS5wb3N0Qm9keSA9IG51bGw7XHJcblx0dm0uYWRkUG9zdCA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcblx0XHRQb3N0c1N2Yy5jcmVhdGUoe1xyXG5cdFx0XHRib2R5OiB2YWx1ZVxyXG5cdFx0fSkudGhlbihmdW5jdGlvbigpIHtcclxuXHRcdFx0dm0ucG9zdEJvZHkgPSBudWxsO1xyXG5cdFx0fSk7XHJcblx0fTtcclxuXHJcblx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KSB7XHJcblx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2bS5wb3N0cy51bnNoaWZ0KHBvc3QpO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcblxyXG5cdFBvc3RzU3ZjLmZldGNoKCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG5cdFx0dm0ucG9zdHMgPSByZXNwb25zZS5kYXRhO1xyXG5cdH0pO1xyXG59XHJcblxyXG5hbmd1bGFyLm1vZHVsZSgnc29jaWFsLWFwcCcpXHJcblx0LmNvbXBvbmVudCgncG9zdHMnLCB7XHJcblx0XHRjb250cm9sbGVyOiBQb3N0c0NvbnRyb2xsZXIsXHJcblx0XHR0ZW1wbGF0ZVVybDogJ3Bvc3RzLmh0bWwnXHJcblx0fSk7IiwiZnVuY3Rpb24gU29jaWFsQ29udHJvbGxlcigpIHtcclxuXHR2YXIgdm0gPSB0aGlzO1xyXG5cdHZtLmxvZ2luID0gZnVuY3Rpb24odXNlcikge1xyXG5cdFx0dm0uY3VycmVudFVzZXIgPSB1c2VyO1xyXG5cdH07XHJcblx0dm0ubG9nb3V0ID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2bS5jdXJyZW50VXNlciA9IG51bGw7XHJcblx0fTtcclxufVxyXG5cclxuYW5ndWxhci5tb2R1bGUoJ3NvY2lhbC1hcHAnKVxyXG5cdC5jb21wb25lbnQoJ3NvY2lhbCcsIHtcclxuXHRcdGNvbnRyb2xsZXI6IFNvY2lhbENvbnRyb2xsZXIsXHJcblx0XHR0ZW1wbGF0ZVVybDogJ3NvY2lhbC5odG1sJ1xyXG5cdH0pOyIsImFuZ3VsYXIubW9kdWxlKCdzb2NpYWwtYXBwJylcclxuXHQuY29tcG9uZW50KCdwb3N0SXRlbScsIHtcclxuXHRcdHRlbXBsYXRlVXJsOiAncG9zdGl0ZW0uaHRtbCcsXHJcblx0XHRiaW5kaW5nczoge1xyXG5cdFx0XHRwb3N0OiAnPCdcclxuXHRcdH1cclxuXHR9KTsiLCJhbmd1bGFyLm1vZHVsZSgnc29jaWFsLWFwcCcpXHJcblx0LnNlcnZpY2UoJ1Bvc3RzU3ZjJyxcclxuXHRcdGZ1bmN0aW9uKCRodHRwKSB7XHJcblx0XHRcdHRoaXMuZmV0Y2ggPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJyk7XHJcblx0XHRcdH07XHJcblx0XHRcdHRoaXMuY3JlYXRlID0gZnVuY3Rpb24ocG9zdCkge1xyXG5cdFx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzJywgcG9zdCk7XHJcblx0XHRcdH07XHJcblx0XHR9XHJcblx0KTtcclxuXHQiLCJhbmd1bGFyLm1vZHVsZSgnc29jaWFsLWFwcCcpXHJcblx0LmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlcikge1xyXG5cdFx0JHJvdXRlUHJvdmlkZXJcclxuXHRcdFx0LndoZW4oJy8nLCB7XHJcblx0XHRcdFx0dGVtcGxhdGU6ICc8cG9zdHM+PC9wb3N0cz4nXHJcblx0XHRcdH0pXHJcblx0XHRcdC53aGVuKCcvcmVnaXN0ZXInLCB7XHJcblx0XHRcdFx0Y29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsXHJcblx0XHRcdFx0dGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJ1xyXG5cdFx0XHR9KVxyXG5cdFx0XHQud2hlbignL2xvZ2luJywge1xyXG5cdFx0XHRcdHRlbXBsYXRlOiAnPGxvZ2luIG9uLXVwZGF0ZT1cIiRjdHJsLmxvZ2luKHZhbHVlKVwiPjwvbG9naW4+J1xyXG5cdFx0XHR9KTtcclxuXHR9KTtcclxuXHQiLCJhbmd1bGFyLm1vZHVsZSgnc29jaWFsLWFwcCcpXHJcblx0LnNlcnZpY2UoJ1VzZXJTdmMnLCBmdW5jdGlvbigkaHR0cCkge1xyXG5cdFx0dmFyIHN2YyA9IHRoaXM7XHJcblx0XHRzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJyk7XHJcblx0XHR9O1xyXG5cdFx0c3ZjLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xyXG5cdFx0XHRcdHVzZXJuYW1lOiB1c2VybmFtZSxcclxuXHRcdFx0XHRwYXNzd29yZDogcGFzc3dvcmRcclxuXHRcdFx0fSkudGhlbihmdW5jdGlvbih2YWwpIHtcclxuXHRcdFx0XHRzdmMudG9rZW4gPSB2YWwuZGF0YTtcclxuXHRcdFx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSB2YWwuZGF0YTtcclxuXHRcdFx0XHRyZXR1cm4gc3ZjLmdldFVzZXIoKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH0pOyIsImFuZ3VsYXIubW9kdWxlKCdzb2NpYWwtYXBwJylcclxuXHQucnVuKGZ1bmN0aW9uKCRyb290U2NvcGUsICR0aW1lb3V0KSB7XHJcblx0XHRmdW5jdGlvbiB3ZWJTb2NrZXRIb3N0KCkge1xyXG5cdFx0XHRpZiAod2luZG93LmxvY2F0aW9uLmhvc3QgPT09IFwiaHR0cHM6XCIpe1xyXG5cdFx0XHRcdHJldHVybiBcIndzczovL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3Q7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmV0dXJuIFwid3M6Ly9cIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHQoZnVuY3Rpb24gY29ubmVjdCgpIHtcclxuXHRcdFx0dmFyIGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHdlYlNvY2tldEhvc3QoKSk7XHJcblx0XHRcdGNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKCdXZWJTb2NrZXQgY2xvc2VkLiBSZWNvbm5lY3RpbmcuLi4nKTtcclxuXHRcdFx0XHQkdGltZW91dChjb25uZWN0LCAxMCAqIDEwMDApO1xyXG5cdFx0XHR9O1xyXG5cdFx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHR2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKTtcclxuXHRcdFx0XHQkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3dzOicgKyBwYXlsb2FkLnRvcGljLCBwYXlsb2FkLmRhdGEpO1xyXG5cdFx0XHR9O1xyXG5cdFx0fSkoKTtcclxuXHR9KTtcclxuXHQiXX0=
