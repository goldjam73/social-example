{"version":3,"sources":["login.controller.js","app.js","postinput.controller.js","posts.controller.js","application.controller.js","postitem.controller.js","posts.service.js","routes.js","user.service.js","websockets.js"],"names":["LoginController","$location","UserSvc","vm","this","login","username","password","then","response","onUpdate","value","data","path","PostInputController","addPost","postBody","PostsController","$scope","PostsSvc","create","body","$on","_","post","$apply","posts","unshift","fetch","$inject","angular","module","controller","user","currentUser","logout","config","$locationProvider","hashPrefix","html5Mode","component","templateUrl","bindings","service","$http","get","$routeProvider","when","template","svc","getUser","val","token","defaults","headers","common","run","$rootScope","$timeout","webSocketHost","window","location","host","connect","connection","WebSocket","onclose","console","log","onmessage","e","payload","JSON","parse","$broadcast","topic"],"mappings":"wBAAA,SAAAA,GAAAC,EAAAC,GCmBA,GAAAC,GAAAC,IDnBAD,GAAAE,MAAA,WCqBAH,EAAAG,MAAAF,EAAAG,SAAAH,EAAAI,UACAC,KAAA,SAAAC,GACAN,EAAAO,UACAC,MAAAF,EAAAG,OAEAX,EAAAY,KAAA,QC1BA,QAAAC,KDwCA,GAAAX,GAAAC,ICxCAD,GAAAY,QAAA,WD0CA,OAAAZ,EAAAa,UACAb,EAAAO,UACAC,MAAAR,EAAAa,YE5CA,QAAAC,GAAAC,EAAAC,GFmEA,GAAAhB,GAAAC,IEnEAD,GAAAa,SAAA,KFqEAb,EAAAY,QAAA,SAAAJ,GACAQ,EAAAC,QACAC,KAAAV,IACAH,KAAA,WACAL,EAAAa,SAAA,QAIAE,EAAAI,IAAA,cAAA,SAAAC,EAAAC,GACArB,EAAAsB,OAAA,WACAtB,EAAAuB,MAAAC,QAAAH,OAIAL,EAAAS,QAAApB,KAAA,SAAAC,GACAN,EAAAuB,MAAAjB,EAAAG,OAnFAZ,EAAA6B,SAAA,YAAA,WACAZ,EAAAY,SAAA,SAAA,YAAAC,QAAAC,OAAA,OADA,YGDAD,QAAAC,OAAA,OHMAC,WAAA,kBAAA,WGNA,GAAA7B,GAAAC,IHQAD,GAAAE,MAAA,SAAA4B,GACA9B,EAAA+B,YAAAD,GAEA9B,EAAAgC,OAAA,eAGAC,QAAA,oBAAA,SAAAC,GACAA,EAAAC,WAAA,IACAD,EAAAE,WAAA,MDHAT,QAAAC,OAAA,OCmBAS,UAAA,SDnBAR,WAAAhC,ECqBAyC,YAAA,aACAC,UACAhC,SAAA,OCzBAoB,QAAAC,OAAA,ODwCAS,UAAA,aCxCAR,WAAAlB,ED0CA2B,YAAA,iBACAC,UACA1B,SAAA,IACAN,SAAA,OIxDAoB,QAAAC,OAAA,OJ4DAS,UAAA,YI5DAC,YAAA,gBJ8DAC,UACAlB,KAAA,OEzCAM,QAAAC,OAAA,OFmEAS,UAAA,SEnEAR,WAAAf,EFqEAwB,YAAA,eK3FAX,QAAAC,OAAA,OL8FAY,QAAA,YK9FA,QAAA,SAAAC,GLgGAxC,KAAAwB,MAAA,WACA,MAAAgB,GAAAC,IAAA,eAEAzC,KAAAgB,OAAA,SAAAI,GACA,MAAAoB,GAAApB,KAAA,aAAAA,OMpGAM,QAAAC,OAAA,ON0GAK,QAAA,iBAAA,SAAAU,GM1GAA,EN4GAC,KAAA,KACAC,SAAA,oBAEAD,KAAA,aACAf,WAAA,eACAS,YAAA,kBAEAM,KAAA,UACAC,SAAA,sDOpHAlB,QAAAC,OAAA,OPyHAY,QAAA,WAAA,QAAA,SAAAC,GOzHA,GAAAK,GAAA7C,IP2HA6C,GAAAC,QAAA,WACA,MAAAN,GAAAC,IAAA,eAEAI,EAAA5C,MAAA,SAAAC,EAAAC,GACA,MAAAqC,GAAApB,KAAA,iBACAlB,SAAAA,EACAC,SAAAA,IACAC,KAAA,SAAA2C,GAGA,MAFAF,GAAAG,MAAAD,EAAAvC,KACAgC,EAAAS,SAAAC,QAAAC,OAAA,UAAAJ,EAAAvC,KACAqC,EAAAC,gBQrIApB,QAAAC,OAAA,OR0IAyB,KAAA,aAAA,WAAA,SAAAC,EAAAC,GQ1IA,QAAAC,KR4IA,MAAA,WAAAC,OAAAC,SAAAC,KACA,SAAAF,OAAAC,SAAAC,KAEA,QAAAF,OAAAC,SAAAC,MAGA,QAAAC,KACA,GAAAC,GAAA,GAAAC,WAAAN,IACAK,GAAAE,QAAA,WACAC,QAAAC,IAAA,qCACAV,EAAAK,EAAA,MAEAC,EAAAK,UAAA,SAAAC,GACA,GAAAC,GAAAC,KAAAC,MAAAH,EAAA1D,KACA6C,GAAAiB,WAAA,MAAAH,EAAAI,MAAAJ,EAAA3D","file":"app.js","sourcesContent":["function LoginController($location, UserSvc) {\n\tvar vm = this;\n\tvm.login = function() {\n\t\tUserSvc.login(vm.username, vm.password)\n\t\t\t.then(function(response) {\n\t\t\t\tvm.onUpdate({\n\t\t\t\t\tvalue: response.data\n\t\t\t\t});\n\t\t\t\t$location.path('/');\n\t\t\t});\n\t};\n}\n\nangular.module('app')\n\t.component('login', {\n\t\tcontroller: LoginController,\n\t\ttemplateUrl: 'login.html',\n\t\tbindings: {\n\t\t\tonUpdate: '&'\n\t\t}\n\t});",null,"function PostInputController() {\n\tvar vm = this;\n\tvm.addPost = function() {\n\t\tif (vm.postBody !== null) {\n\t\t\tvm.onUpdate({\n\t\t\t\tvalue: vm.postBody\n\t\t\t});\n\t\t}\n\t};\n}\n\nangular.module('app')\n\t.component('postInput', {\n\t\tcontroller: PostInputController,\n\t\ttemplateUrl: 'postinput.html',\n\t\tbindings: {\n\t\t\tpostBody: '<',\n\t\t\tonUpdate: '&'\n\t\t}\n\t});","function PostsController($scope, PostsSvc) {\n\tvar vm = this;\n\tvm.postBody = null;\n\tvm.addPost = function(value) {\n\t\tPostsSvc.create({\n\t\t\tbody: value\n\t\t}).then(function() {\n\t\t\tvm.postBody = null;\n\t\t});\n\t};\n\n\t$scope.$on('ws:new_post', function(_, post) {\n\t\tvm.$apply(function() {\n\t\t\tvm.posts.unshift(post);\n\t\t});\n\t});\n\n\tPostsSvc.fetch().then(function(response) {\n\t\tvm.posts = response.data;\n\t});\n}\n\nangular.module('app')\n\t.component('posts', {\n\t\tcontroller: PostsController,\n\t\ttemplateUrl: 'posts.html'\n\t});","angular.module('app')\n\t.controller('ApplicationCtrl', function() {\n\t\tvar vm = this;\n\t\tvm.login = function(user) {\n\t\t\tvm.currentUser = user;\n\t\t};\n\t\tvm.logout = function() {\n\t\t\t//\n\t\t};\n\t}).config(['$locationProvider', function($locationProvider) {\n\t\t$locationProvider.hashPrefix('');\n\t\t$locationProvider.html5Mode(true);\n\t}]);","angular.module('app')\n\t.component('postItem', {\n\t\ttemplateUrl: 'postitem.html',\n\t\tbindings: {\n\t\t\tpost: '<'\n\t\t}\n\t});","angular.module('app')\n\t.service('PostsSvc',\n\t\tfunction($http) {\n\t\t\tthis.fetch = function() {\n\t\t\t\treturn $http.get('/api/posts');\n\t\t\t};\n\t\t\tthis.create = function(post) {\n\t\t\t\treturn $http.post('/api/posts', post);\n\t\t\t};\n\t\t}\n\t);\n\t","angular.module('app')\r\n\t.config(function($routeProvider) {\r\n\t\t$routeProvider\r\n\t\t\t.when('/', {\r\n\t\t\t\ttemplate: '<posts></posts>'\r\n\t\t\t})\r\n\t\t\t.when('/register', {\r\n\t\t\t\tcontroller: 'RegisterCtrl',\r\n\t\t\t\ttemplateUrl: 'register.html'\r\n\t\t\t})\r\n\t\t\t.when('/login', {\r\n\t\t\t\ttemplate: '<login on-update=\"$ctrl.login(value)\"></login>'\r\n\t\t\t});\r\n\t});\r\n\t","angular.module('app')\n\t.service('UserSvc', function($http) {\n\t\tvar svc = this;\n\t\tsvc.getUser = function() {\n\t\t\treturn $http.get('/api/users');\n\t\t};\n\t\tsvc.login = function(username, password) {\n\t\t\treturn $http.post('/api/sessions', {\n\t\t\t\tusername: username,\n\t\t\t\tpassword: password\n\t\t\t}).then(function(val) {\n\t\t\t\tsvc.token = val.data;\n\t\t\t\t$http.defaults.headers.common['X-Auth'] = val.data;\n\t\t\t\treturn svc.getUser();\n\t\t\t});\n\t\t};\n\t});","angular.module('app')\r\n\t.run(function($rootScope, $timeout) {\r\n\t\tfunction webSocketHost() {\r\n\t\t\tif (window.location.host === \"https:\"){\r\n\t\t\t\treturn \"wss://\" + window.location.host;\r\n\t\t\t} else {\r\n\t\t\t\treturn \"ws://\" + window.location.host;\r\n\t\t\t}\r\n\t\t}\r\n\t\t(function connect() {\r\n\t\t\tvar connection = new WebSocket(webSocketHost());\r\n\t\t\tconnection.onclose = function() {\r\n\t\t\t\tconsole.log('WebSocket closed. Reconnecting...');\r\n\t\t\t\t$timeout(connect, 10 * 1000);\r\n\t\t\t};\r\n\t\t\tconnection.onmessage = function(e) {\r\n\t\t\t\tvar payload = JSON.parse(e.data);\r\n\t\t\t\t$rootScope.$broadcast('ws:' + payload.topic, payload.data);\r\n\t\t\t};\r\n\t\t})();\r\n\t});\r\n\t"]}