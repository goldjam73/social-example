{"version":3,"sources":["login.component.js","app.js","postinput.component.js","posts.component.js","social.component.js","postitem.component.js","posts.service.js","routes.js","user.service.js","websockets.js"],"names":["LoginController","$location","UserSvc","vm","this","login","username","password","then","response","onUpdate","value","data","path","PostInputController","addPost","postBody","PostsController","$scope","PostsSvc","create","body","$on","_","post","$apply","posts","unshift","fetch","SocialController","user","currentUser","logout","$inject","angular","module","config","$locationProvider","hashPrefix","html5Mode","component","controller","templateUrl","bindings","service","$http","get","$routeProvider","when","template","svc","getUser","val","token","defaults","headers","common","run","$rootScope","$timeout","webSocketHost","window","location","host","connect","connection","WebSocket","onclose","console","log","onmessage","e","payload","JSON","parse","$broadcast","topic"],"mappings":"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","file":"app.js","sourcesContent":["function LoginController($location, UserSvc) {\r\n\tvar vm = this;\r\n\tvm.login = function() {\r\n\t\tUserSvc.login(vm.username, vm.password)\r\n\t\t\t.then(function(response) {\r\n\t\t\t\tvm.onUpdate({\r\n\t\t\t\t\tvalue: response.data\r\n\t\t\t\t});\r\n\t\t\t\t$location.path('/');\r\n\t\t\t});\r\n\t};\r\n}\r\n\r\nangular.module('social-app')\r\n\t.component('login', {\r\n\t\tcontroller: LoginController,\r\n\t\ttemplateUrl: 'login.html',\r\n\t\tbindings: {\r\n\t\t\tonUpdate: '&'\r\n\t\t}\r\n\t});",null,"function PostInputController() {\r\n\tvar vm = this;\r\n\tvm.addPost = function() {\r\n\t\tif (vm.postBody !== null) {\r\n\t\t\tvm.onUpdate({\r\n\t\t\t\tvalue: vm.postBody\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n}\r\n\r\nangular.module('social-app')\r\n\t.component('postInput', {\r\n\t\tcontroller: PostInputController,\r\n\t\ttemplateUrl: 'postinput.html',\r\n\t\tbindings: {\r\n\t\t\tpostBody: '<',\r\n\t\t\tonUpdate: '&'\r\n\t\t}\r\n\t});","function PostsController($scope, PostsSvc) {\r\n\tvar vm = this;\r\n\tvm.postBody = null;\r\n\tvm.addPost = function(value) {\r\n\t\tPostsSvc.create({\r\n\t\t\tbody: value\r\n\t\t}).then(function() {\r\n\t\t\tvm.postBody = null;\r\n\t\t});\r\n\t};\r\n\r\n\t$scope.$on('ws:new_post', function(_, post) {\r\n\t\tvm.$apply(function() {\r\n\t\t\tvm.posts.unshift(post);\r\n\t\t});\r\n\t});\r\n\r\n\tPostsSvc.fetch().then(function(response) {\r\n\t\tvm.posts = response.data;\r\n\t});\r\n}\r\n\r\nangular.module('social-app')\r\n\t.component('posts', {\r\n\t\tcontroller: PostsController,\r\n\t\ttemplateUrl: 'posts.html'\r\n\t});","function SocialController() {\r\n\tvar vm = this;\r\n\tvm.login = function(user) {\r\n\t\tvm.currentUser = user;\r\n\t};\r\n\tvm.logout = function() {\r\n\t\tvm.currentUser = null;\r\n\t};\r\n}\r\n\r\nangular.module('social-app')\r\n\t.component('social', {\r\n\t\tcontroller: SocialController,\r\n\t\ttemplateUrl: 'social.html'\r\n\t});","angular.module('social-app')\r\n\t.component('postItem', {\r\n\t\ttemplateUrl: 'postitem.html',\r\n\t\tbindings: {\r\n\t\t\tpost: '<'\r\n\t\t}\r\n\t});","angular.module('social-app')\r\n\t.service('PostsSvc',\r\n\t\tfunction($http) {\r\n\t\t\tthis.fetch = function() {\r\n\t\t\t\treturn $http.get('/api/posts');\r\n\t\t\t};\r\n\t\t\tthis.create = function(post) {\r\n\t\t\t\treturn $http.post('/api/posts', post);\r\n\t\t\t};\r\n\t\t}\r\n\t);\r\n\t","angular.module('social-app')\r\n\t.config(function($routeProvider) {\r\n\t\t$routeProvider\r\n\t\t\t.when('/', {\r\n\t\t\t\ttemplate: '<posts></posts>'\r\n\t\t\t})\r\n\t\t\t.when('/register', {\r\n\t\t\t\tcontroller: 'RegisterCtrl',\r\n\t\t\t\ttemplateUrl: 'register.html'\r\n\t\t\t})\r\n\t\t\t.when('/login', {\r\n\t\t\t\ttemplate: '<login on-update=\"$ctrl.login(value)\"></login>'\r\n\t\t\t});\r\n\t});\r\n\t","angular.module('social-app')\r\n\t.service('UserSvc', function($http) {\r\n\t\tvar svc = this;\r\n\t\tsvc.getUser = function() {\r\n\t\t\treturn $http.get('/api/users');\r\n\t\t};\r\n\t\tsvc.login = function(username, password) {\r\n\t\t\treturn $http.post('/api/sessions', {\r\n\t\t\t\tusername: username,\r\n\t\t\t\tpassword: password\r\n\t\t\t}).then(function(val) {\r\n\t\t\t\tsvc.token = val.data;\r\n\t\t\t\t$http.defaults.headers.common['X-Auth'] = val.data;\r\n\t\t\t\treturn svc.getUser();\r\n\t\t\t});\r\n\t\t};\r\n\t});","angular.module('social-app')\r\n\t.run(function($rootScope, $timeout) {\r\n\t\tfunction webSocketHost() {\r\n\t\t\tif (window.location.host === \"https:\"){\r\n\t\t\t\treturn \"wss://\" + window.location.host;\r\n\t\t\t} else {\r\n\t\t\t\treturn \"ws://\" + window.location.host;\r\n\t\t\t}\r\n\t\t}\r\n\t\t(function connect() {\r\n\t\t\tvar connection = new WebSocket(webSocketHost());\r\n\t\t\tconnection.onclose = function() {\r\n\t\t\t\tconsole.log('WebSocket closed. Reconnecting...');\r\n\t\t\t\t$timeout(connect, 10 * 1000);\r\n\t\t\t};\r\n\t\t\tconnection.onmessage = function(e) {\r\n\t\t\t\tvar payload = JSON.parse(e.data);\r\n\t\t\t\t$rootScope.$broadcast('ws:' + payload.topic, payload.data);\r\n\t\t\t};\r\n\t\t})();\r\n\t});\r\n\t"]}