{"version":3,"sources":["login.controller.js","app.js","postinput.controller.js","posts.controller.js","application.controller.js","postitem.controller.js","posts.service.js","routes.js","user.service.js","websockets.js"],"names":["LoginController","$location","UserSvc","vm","this","login","username","password","then","response","onUpdate","value","data","path","PostInputController","addPost","postBody","PostsController","$scope","PostsSvc","create","body","$on","_","post","$apply","posts","unshift","fetch","$inject","angular","module","controller","user","currentUser","logout","component","templateUrl","bindings","service","$http","get","config","$routeProvider","when","template","svc","getUser","val","token","defaults","headers","common","run","$rootScope","$timeout","webSocketHost","window","location","host","connect","connection","WebSocket","onclose","console","log","onmessage","e","payload","JSON","parse","$broadcast","topic"],"mappings":"wBAAA,SAAAA,GAAAC,EAAAC,GCgBA,GAAAC,GAAAC,IDhBAD,GAAAE,MAAA,WCkBAH,EAAAG,MAAAF,EAAAG,SAAAH,EAAAI,UACAC,KAAA,SAAAC,GACAN,EAAAO,UACAC,MAAAF,EAAAG,OAEAX,EAAAY,KAAA,QCvBA,QAAAC,KDqCA,GAAAX,GAAAC,ICrCAD,GAAAY,QAAA,WDuCA,OAAAZ,EAAAa,UACAb,EAAAO,UACAC,MAAAR,EAAAa,YEzCA,QAAAC,GAAAC,EAAAC,GFgEA,GAAAhB,GAAAC,IEhEAD,GAAAa,SAAA,KFkEAb,EAAAY,QAAA,SAAAJ,GACAQ,EAAAC,QACAC,KAAAV,IACAH,KAAA,WACAL,EAAAa,SAAA,QAIAE,EAAAI,IAAA,cAAA,SAAAC,EAAAC,GACArB,EAAAsB,OAAA,WACAtB,EAAAuB,MAAAC,QAAAH,OAIAL,EAAAS,QAAApB,KAAA,SAAAC,GACAN,EAAAuB,MAAAjB,EAAAG,OAhFAZ,EAAA6B,SAAA,YAAA,WACAZ,EAAAY,SAAA,SAAA,YAAAC,QAAAC,OAAA,OADA,YGDAD,QAAAC,OAAA,OHMAC,WAAA,kBAAA,WGNA,GAAA7B,GAAAC,IHQAD,GAAAE,MAAA,SAAA4B,GACA9B,EAAA+B,YAAAD,GAEA9B,EAAAgC,OAAA,eDEAL,QAAAC,OAAA,OCgBAK,UAAA,SDhBAJ,WAAAhC,ECkBAqC,YAAA,aACAC,UACA5B,SAAA,OCtBAoB,QAAAC,OAAA,ODqCAK,UAAA,aCrCAJ,WAAAlB,EDuCAuB,YAAA,iBACAC,UACAtB,SAAA,IACAN,SAAA,OIrDAoB,QAAAC,OAAA,OJyDAK,UAAA,YIzDAC,YAAA,gBJ2DAC,UACAd,KAAA,OEtCAM,QAAAC,OAAA,OFgEAK,UAAA,SEhEAJ,WAAAf,EFkEAoB,YAAA,eKxFAP,QAAAC,OAAA,OL2FAQ,QAAA,YK3FA,QAAA,SAAAC,GL6FApC,KAAAwB,MAAA,WACA,MAAAY,GAAAC,IAAA,eAEArC,KAAAgB,OAAA,SAAAI,GACA,MAAAgB,GAAAhB,KAAA,aAAAA,OMjGAM,QAAAC,OAAA,ONuGAW,QAAA,iBAAA,SAAAC,GMvGAA,ENyGAC,KAAA,KACAC,SAAA,oBAEAD,KAAA,aACAZ,WAAA,eACAK,YAAA,kBAEAO,KAAA,UACAC,SAAA,sDOjHAf,QAAAC,OAAA,OPsHAQ,QAAA,WAAA,QAAA,SAAAC,GOtHA,GAAAM,GAAA1C,IPwHA0C,GAAAC,QAAA,WACA,MAAAP,GAAAC,IAAA,eAEAK,EAAAzC,MAAA,SAAAC,EAAAC,GACA,MAAAiC,GAAAhB,KAAA,iBACAlB,SAAAA,EACAC,SAAAA,IACAC,KAAA,SAAAwC,GAGA,MAFAF,GAAAG,MAAAD,EAAApC,KACA4B,EAAAU,SAAAC,QAAAC,OAAA,UAAAJ,EAAApC,KACAkC,EAAAC,gBQlIAjB,QAAAC,OAAA,ORuIAsB,KAAA,aAAA,WAAA,SAAAC,EAAAC,GQvIA,QAAAC,KRyIA,MAAA,WAAAC,OAAAC,SAAAC,KACA,SAAAF,OAAAC,SAAAC,KAEA,QAAAF,OAAAC,SAAAC,MAGA,QAAAC,KACA,GAAAC,GAAA,GAAAC,WAAAN,IACAK,GAAAE,QAAA,WACAC,QAAAC,IAAA,qCACAV,EAAAK,EAAA,MAEAC,EAAAK,UAAA,SAAAC,GACA,GAAAC,GAAAC,KAAAC,MAAAH,EAAAvD,KACA0C,GAAAiB,WAAA,MAAAH,EAAAI,MAAAJ,EAAAxD","file":"app.js","sourcesContent":["function LoginController($location, UserSvc) {\r\n\tvar vm = this;\r\n\tvm.login = function() {\r\n\t\tUserSvc.login(vm.username, vm.password)\r\n\t\t\t.then(function(response) {\r\n\t\t\t\tvm.onUpdate({\r\n\t\t\t\t\tvalue: response.data\r\n\t\t\t\t});\r\n\t\t\t\t$location.path('/');\r\n\t\t\t});\r\n\t};\r\n}\r\n\r\nangular.module('app')\r\n\t.component('login', {\r\n\t\tcontroller: LoginController,\r\n\t\ttemplateUrl: 'login.html',\r\n\t\tbindings: {\r\n\t\t\tonUpdate: '&'\r\n\t\t}\r\n\t});",null,"function PostInputController() {\r\n\tvar vm = this;\r\n\tvm.addPost = function() {\r\n\t\tif (vm.postBody !== null) {\r\n\t\t\tvm.onUpdate({\r\n\t\t\t\tvalue: vm.postBody\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n}\r\n\r\nangular.module('app')\r\n\t.component('postInput', {\r\n\t\tcontroller: PostInputController,\r\n\t\ttemplateUrl: 'postinput.html',\r\n\t\tbindings: {\r\n\t\t\tpostBody: '<',\r\n\t\t\tonUpdate: '&'\r\n\t\t}\r\n\t});","function PostsController($scope, PostsSvc) {\r\n\tvar vm = this;\r\n\tvm.postBody = null;\r\n\tvm.addPost = function(value) {\r\n\t\tPostsSvc.create({\r\n\t\t\tbody: value\r\n\t\t}).then(function() {\r\n\t\t\tvm.postBody = null;\r\n\t\t});\r\n\t};\r\n\r\n\t$scope.$on('ws:new_post', function(_, post) {\r\n\t\tvm.$apply(function() {\r\n\t\t\tvm.posts.unshift(post);\r\n\t\t});\r\n\t});\r\n\r\n\tPostsSvc.fetch().then(function(response) {\r\n\t\tvm.posts = response.data;\r\n\t});\r\n}\r\n\r\nangular.module('app')\r\n\t.component('posts', {\r\n\t\tcontroller: PostsController,\r\n\t\ttemplateUrl: 'posts.html'\r\n\t});","angular.module('app')\r\n\t.controller('ApplicationCtrl', function() {\r\n\t\tvar vm = this;\r\n\t\tvm.login = function(user) {\r\n\t\t\tvm.currentUser = user;\r\n\t\t};\r\n\t\tvm.logout = function() {\r\n\t\t\t//\r\n\t\t};\r\n\t});","angular.module('app')\r\n\t.component('postItem', {\r\n\t\ttemplateUrl: 'postitem.html',\r\n\t\tbindings: {\r\n\t\t\tpost: '<'\r\n\t\t}\r\n\t});","angular.module('app')\r\n\t.service('PostsSvc',\r\n\t\tfunction($http) {\r\n\t\t\tthis.fetch = function() {\r\n\t\t\t\treturn $http.get('/api/posts');\r\n\t\t\t};\r\n\t\t\tthis.create = function(post) {\r\n\t\t\t\treturn $http.post('/api/posts', post);\r\n\t\t\t};\r\n\t\t}\r\n\t);\r\n\t","angular.module('app')\r\n\t.config(function($routeProvider) {\r\n\t\t$routeProvider\r\n\t\t\t.when('/', {\r\n\t\t\t\ttemplate: '<posts></posts>'\r\n\t\t\t})\r\n\t\t\t.when('/register', {\r\n\t\t\t\tcontroller: 'RegisterCtrl',\r\n\t\t\t\ttemplateUrl: 'register.html'\r\n\t\t\t})\r\n\t\t\t.when('/login', {\r\n\t\t\t\ttemplate: '<login on-update=\"$ctrl.login(value)\"></login>'\r\n\t\t\t});\r\n\t});\r\n\t","angular.module('app')\r\n\t.service('UserSvc', function($http) {\r\n\t\tvar svc = this;\r\n\t\tsvc.getUser = function() {\r\n\t\t\treturn $http.get('/api/users');\r\n\t\t};\r\n\t\tsvc.login = function(username, password) {\r\n\t\t\treturn $http.post('/api/sessions', {\r\n\t\t\t\tusername: username,\r\n\t\t\t\tpassword: password\r\n\t\t\t}).then(function(val) {\r\n\t\t\t\tsvc.token = val.data;\r\n\t\t\t\t$http.defaults.headers.common['X-Auth'] = val.data;\r\n\t\t\t\treturn svc.getUser();\r\n\t\t\t});\r\n\t\t};\r\n\t});","angular.module('app')\r\n\t.run(function($rootScope, $timeout) {\r\n\t\tfunction webSocketHost() {\r\n\t\t\tif (window.location.host === \"https:\"){\r\n\t\t\t\treturn \"wss://\" + window.location.host;\r\n\t\t\t} else {\r\n\t\t\t\treturn \"ws://\" + window.location.host;\r\n\t\t\t}\r\n\t\t}\r\n\t\t(function connect() {\r\n\t\t\tvar connection = new WebSocket(webSocketHost());\r\n\t\t\tconnection.onclose = function() {\r\n\t\t\t\tconsole.log('WebSocket closed. Reconnecting...');\r\n\t\t\t\t$timeout(connect, 10 * 1000);\r\n\t\t\t};\r\n\t\t\tconnection.onmessage = function(e) {\r\n\t\t\t\tvar payload = JSON.parse(e.data);\r\n\t\t\t\t$rootScope.$broadcast('ws:' + payload.topic, payload.data);\r\n\t\t\t};\r\n\t\t})();\r\n\t});\r\n\t"]}